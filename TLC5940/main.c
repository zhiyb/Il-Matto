#include <stdint.h>
#include <avr/io.h>
#include <util/delay.h>
#include "tlc5940.h"

void init()
{
	DDRB |= _BV(7);
	PORTB |= _BV(7);

	tlc5940_init();
}

int main()
{
	init();
	tlc5940_blank(0);

#if 1
	static uint8_t gs[16] = {
#if 0
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
#elif 0
		0x00, 0xff, 0x10, 0xef, 0x20, 0xdf, 0x30, 0xcf,
		0x40, 0xbf, 0x50, 0xaf, 0x60, 0x9f, 0x70, 0x8f,
#elif 1
		0x00, 0xff, 0x00, 0xff, 0x00, 0xff, 0x00, 0xff,
		0x00, 0xff, 0x00, 0xff, 0x00, 0xff, 0x00, 0xff,
#else
		0x00, 0x10, 0x20, 0x30, 0x40, 0x50, 0x60, 0x70,
		0x80, 0x90, 0xa0, 0xb0, 0xc0, 0xd0, 0xe0, 0xf0,
#endif
	};
#else
	static uint8_t gs[2] = {
		0x00, 0xff,
	};
#endif
	uint8_t i;
loop:
	tlc5940_set_gs(sizeof(gs), 1, gs);
	_delay_ms(500);

	for (i = 0; i < sizeof(gs); i++)
		gs[i] ^= 0xff;

	PINB |= _BV(7);
	goto loop;
	return 1;
}
